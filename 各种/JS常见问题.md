# JS 常见问题

## 1. 浮点数陷阱

`Number` 使用64位固定长度来表示, 既标准的 double 双精度浮点数.

主要原因数字转化为二进制后变成了一个无限循环的数字, 计算机进行了舍入处理,结果转换成十进制时就会有误差.

```js
// 0.1 和 0.2 都转化成二进制后再进行运算
0.00011001100110011001100110011001100110011001100110011010 +
0.0011001100110011001100110011001100110011001100110011010 =
0.0100110011001100110011001100110011001100110011001100111

// 转成十进制正好是 0.30000000000000004
```

为什么 x=0.1 能得到0.1 ?

```js
0.10000000000000000555.toPrecision(16)
// 返回 0.1000000000000000，去掉末尾的零后正好为 0.1

// 但你看到的 `0.1` 实际上并不是 `0.1`。不信你可用更高的精度试试：
0.1.toPrecision(21) = 0.100000000000000005551
```

解决方案:

1. 展示类: 使用 `toPrecision` 凑整并 `parseFloat` 转成数字后再显示

```js
  parseFloat(1.4000000000000001.toPrecision(12)) === 1.4  // True

  function strip(num, precision = 12) {
    return +parseFloat(num.toPrecision(precision));
  }
```

2. 运算类